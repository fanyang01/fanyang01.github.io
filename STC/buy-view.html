<link rel="import" href="bower_components/polymer/polymer.html">
<dom-module id='buy-view'>
  <style>
  @media(min-width: 600px) {
    div.table-container {
      margin: 10px auto;
      max-width: 54em;
    }
  }
  div.top-buttons {
    margin-top: 20px;
    padding: 0 15px;
  }
  #large-card-container {
    margin: 10px auto;
    max-width: 95%;
  }
  @media (max-width: 600px) {
    div.cards {
      margin-top: 20px;
    }
    div.card-container {
      width: 100%;
      margin: 0;
      padding-right: 6px;
    }
  }
  @media (min-width: 600px) {
    div.card-container {
      margin-right: 25px;
    }
    div.cards {
      display: flex;
      flex-flow: row wrap;
      justify-content: flex-start;
    }
  }  
  @media (max-width: 600px) {
    div.cards {
      justify-content: space-around;
    }
  }
  #drawer-container {
    margin-top: 20px;
  }
  </style>
  <template>
    <paper-header-panel class="flex">
      <paper-toolbar>
        <paper-icon-button icon="menu" on-click="toggleMainDrawer" paper-drawer-toggle></paper-icon-button>
        <span class="title">购买股票</span>
        <div class="flex"></div>
        <paper-icon-button
          icon$="{{togglePanelIcon(selectedPanel)}}"
          hidden$="{{hideRightIcon(largeScreen, selected.length, selectedPanel)}}"
          on-click="toggleRightDrawer">
        </paper-icon-button>
      </paper-toolbar>
      <div class="prompt" hidden$="[[isNotEmpty(collection.length)]]">
        Nothing in portfolio, go to search and select some...
      </div>
      <div hidden$="[[!isNotEmpty(collection.length)]]" class="vertical layout">
        <div id="large-screen-container" hidden$="{{!largeScreen}}">
          <div class="top-buttons horizontal layout around-justified">
            <paper-button on-click="clear">
              <iron-icon icon="clear"></iron-icon>
              <span>Clear</span>
            </paper-button>
            <paper-button>
              <iron-icon icon="remove-circle-outline"></iron-icon>
              <span>Remove</span>
            </paper-button>
          </div>
          <div class="table-container fullbleed">
            <more-table headers="[[tableHeader]]" data="[[collection]]"
              selectable
              selected="{{selected}}"
              forward-button
              on-click-forward="gotoDetailsPage">
            </more-table>
          </div>
          <!-- cards -->
          <div class="vertial layout" id="large-card-container">
            <div class="cards">
              <template is="dom-repeat" items="{{selected}}">
                <div class="card-container">
                  <stock-card stock="{{item}}" on-click-close="handleClose"></stock-card>
                </div>
              </template>
            </div>
            <div class="horizontal layout around-justified" class="buttons">
              <paper-button raised id="button-confirm" disabled$='{{invalid(selected.length)}}'>
                <iron-icon icon="check"></iron-icon>
                <span>确认购买</span>
              </paper-button>
            </div>
          </div>
        </div>
        <!-- for small screens -->
        <div id="small-screen-container" hidden$="{{largeScreen}}">
          <paper-drawer-panel right-drawer drawer-width="90%" id="rightDrawerPanel" disable-swipe selected="{{selectedPanel}}">
            <paper-header-panel drawer id="right-drawer">
              <div class="vertial layout" id="drawer-container">
                <div class="horizontal layout around-justified" class="buttons">
                  <paper-button raised id="button-confirm" disabled$='{{invalid(selected.length)}}'>
                    <iron-icon icon="check"></iron-icon>
                    <span>确认出售</span>
                  </paper-button>
                </div>
                <!--  -->
                <div class="cards">
                  <template is="dom-repeat" items="{{selected}}">
                    <div class="card-container">
                      <stock-card stock="{{item}}" on-click-close="handleClose"></stock-card>
                    </div>
                  </template>
                </div>
              </div>
            </paper-header-panel>
            <!--  -->
            <paper-header-panel main>
              <div class="top-buttons horizontal layout around-justified">
                <paper-button on-click="clear">
                  <iron-icon icon="clear"></iron-icon>
                  <span>Clear</span>
                </paper-button>
                <paper-button>
                  <iron-icon icon="remove-circle-outline"></iron-icon>
                  <span>Remove</span>
                </paper-button>
              </div>
              <div id="small-main-container">
                <more-table selectable
                  forward-button
                  on-click-forward="gotoDetailsPage"
                  data="[[collection]]"
                  selected="{{selected}}"
                  headers="[[tableHeader]]">
                </more-table>
              </div>
            </paper-header-panel>
          </paper-drawer-panel>
        </div>
      </div>
    </paper-header-panel>
    <iron-media-query query="min-width: 600px" query-matches="{{largeScreen}}">
    </iron-media-query>
  </template>
  <script>
  Polymer({
    is: 'buy-view',
    properties: {
      collection: {
        type: Array,
        value: function() {
          return [];
        },
        notify: true
      },
      selected: {
        type: Array,
        value: function() {
          return [];
        }
      }
    },
    behaviors: [ToggleMainDrawerBehavior, BuySellViewBehavior],
    isNotEmpty: function(len) {
      return len > 0;
    },
    ready: function() {
      this.collection = [{
          id: '123456',
          name: 'Google',
          currentPrice: '1234',
          change: '2.34%',
          yesterday: '1230',
          riseLimit: '1250',
          downLimit: '1200'
        }, {
          id: '123457',
          name: 'Amazon',
          currentPrice: '1234',
          change: '2.34%',
          yesterday: '1230',
          riseLimit: '1250',
          downLimit: '1200'
        }, {
          id: '123458',
          name: 'Yahoo',
          currentPrice: '1234',
          change: '2.34%',
          yesterday: '1230',
          riseLimit: '1250',
          downLimit: '1200'
        }],
        this.tableHeader = [{
          label: 'Stock Code',
          attr: 'id'
        }, {
          label: 'Stock Name',
          attr: 'name'
        }, {
          label: 'Current Price',
          attr: 'currentPrice'
        }, {
          label: 'Yesterday',
          attr: 'yesterday'
        }, {
          label: 'Change',
          attr: 'change'
        }, {
          label: 'RiseLimit',
          attr: 'riseLimit'
        }, {
          label: 'DownLimit',
          attr: 'downLimit'
        }]
    }
  })
  </script>
</dom-module>
